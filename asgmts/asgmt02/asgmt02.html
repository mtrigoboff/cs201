<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/asgmt.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<!-- template parameters -->
<!-- InstanceParam name="course" type="text" value="CS201" -->
<!-- InstanceParam name="asgmtVersion" type="text" value="2" -->
<title>CS201 Assignment 2</title>
<style type="text/css">
<!--
.code {
	font-family: Consolas, "Courier New", Courier, monospace;
	font-size: 14px;
}
body {
	font-family: Cambria, Georgia, "Times New Roman", Times, serif;
	font-size: 14px;
}
.header {
	font-family: Cambria, Georgia, "Times New Roman", Times, serif;
	font-size: 22px;
	font-weight: normal;
	text-decoration: underline;
}
.title {
	font-size: 24px;
	font-weight: bold;
	text-decoration: underline;
	font-family: Cambria, Georgia, "Times New Roman", Times, serif;
}
table caption {
	font-size: 18px;
	text-align: left;
	line-height: 44px;
	vertical-align: top;
	text-decoration: underline;
}
th {
	font-weight: normal;
	text-align: left;
	text-decoration: underline;
}
-->
</style>
</head>
<body>
<p class="title">CS201 Assignment 2 Instructions</p>
<!-- InstanceBeginEditable name="description" -->
<p><em>Remember that you only need to do one of the assignments below.</em></p>
<p>In each of these assignments, you will be asked to write a &ldquo;math library&rdquo; function. You will be writing the function in assembly language, using gcc&rsquo;s <span style="font-weight: bold">inline assembler</span>. In addition to the documentation provided here, code files <span style="font-weight: bold">asm.c</span> and <span style="font-weight: bold">cpuid.c</span> are good models for how to write assembly code for gcc. (The files mentioned above <span style="font-weight: bold">in bold</span> are available as links from the &ldquo;About This Lesson&rdquo; page of the &ldquo;Understanding Object Code&rdquo; lesson. </p>
<p>You can use a mixture of C code and assembly code for these assignments, but <em>all floating point calculations must be done in assembly language</em>. You should use C only for support tasks like defining local variables, returning a value from the function, etc. </p>
<p>The IA-32 Architecture includes the floating point instructions needed to implement these functions. <em>You will save yourself a lot of work if you carefully choose the right instructions</em>. This is a large and powerful instruction set, and you should make use of that power instead of &ldquo;re-inventing the wheel.&rdquo;</p>
<p>In other words, don&rsquo;t spend a lot of time writing a lot of dumb code. Instead, spend your time <em>thinking</em> first, and you will be able to write a smaller amount of smart code. </p>
<p>Loops are not necessary for any of these assignments, and your code should not include them. <em>Do not</em> implement a mathematical solution such as a power series. There is no need for something like this and doing all that unneccessary work will reflect poorly on your understanding of the instructions available in the IA-32 Architecture. </p>
<p>If you need to examine or alter the value of the FPU Control Word, you can use the <span class="code1">fldcw</span> and <span class="code1">fstcw</span> instructions.</p>
<hr />
<h3><!-- #BeginLibraryItem "/Library/Regular.lbi" --> <strong>Regular</strong><!-- #EndLibraryItem --> Assignment (100 points) </h3>
<p>Write a function named <span class="code1">absD</span> that returns the absolute value of its argument (the D indicates that the argument and return value are of type <span class="code1">double</span>). The function prototype is:</p>
<blockquote>
  <p class="code1">double absD (double n); </p>
</blockquote>
<p>Start with the provided code  file a02.c. Upload your code as <strong>a02.c</strong>. </p>
<hr />
<h3><!-- #BeginLibraryItem "/Library/Premium.lbi" --> <strong>Premium</strong><!-- #EndLibraryItem --> Assignment (200 points) </h3>
<p>Write a function named <span class="code1">roundD</span> that rounds its first argument to an  integer value according to the mode specified by its second argument. The function prototype is:</p>
<blockquote>
  <p class="code1">double roundD (double n, RoundingMode roundingMode);</p>
</blockquote>
<p><span class="code1">RoundingMode</span> is defined as follows:</p>
<blockquote>
  <pre>#define RND_CTL_BIT_SHIFT   10

// floating point rounding modes: IA-32 Manual, Vol. 1, p. 4-20
typedef enum {
    ROUND_NEAREST_EVEN =    0 &lt;&lt; RND_CTL_BIT_SHIFT,
    ROUND_MINUS_INF =       1 &lt;&lt; RND_CTL_BIT_SHIFT,
    ROUND_PLUS_INF =        2 &lt;&lt; RND_CTL_BIT_SHIFT,
    ROUND_TOWARD_ZERO =     3 &lt;&lt; RND_CTL_BIT_SHIFT
} RoundingMode;</pre>
</blockquote>
<p>You will need to set the Rounding Control field of the FPU Control Word in accordance with the second argument.</p>
<p>You wil also need  to restore the original value of the Rounding Control field before <span class="code1">roundD</span> returns. Do not use <span class="code1">finit</span> or <span class="code1">fninit</span> for this. The original value is whatever the value was when <span class="code1">roundD</span> was called, which could have been set by the calling function to some arbitrary value, not necessarily what <span class="code1">finit</span> produces. </p>
<p>Start with the provided code  file a02p.c. Upload your code as <strong>a02p.c</strong>. </p>
<hr />
<h3>Super <!-- #BeginLibraryItem "/Library/Premium.lbi" --> <strong>Premium</strong><!-- #EndLibraryItem --> Assignment (300 points) </h3>
<p><em>This is a very challenging assignment. It&rsquo;s here for those of you who like an extra challenge, and to provide an opportunity to &ldquo;catch up&rdquo; for students who didn&rsquo;t do well on a previous quiz or assignment. You may need the results of the <!-- #BeginLibraryItem "/Library/Premium.lbi" --> <strong>Premium</strong><!-- #EndLibraryItem --> assignment above in order to do this assignment. </em></p>
<p>Write a function named <span class="code1">powD</span> that raises its first argument to the power of its second argument. The function prototype is:</p>
<blockquote>
  <p><span class="code1">double powD (double n, double exp);</span></p>
</blockquote>
<p>The value returned by <span class="code1">powD</span> will be <span class="code1">n<sup>exp</sup></span>. Note that <span class="code1">n</span> and <span class="code1">exp</span> are not required to be integer values. Your code will have to handle cases like 2.7<sup> 4.3</sup>, etc. Your function should exactly match the results returned by the C standard function <span class="code1">pow</span>, which is defined in <span class="code1">math.h</span>. This includes cases which return infinity or a NaN. For instance, <span class="code1">pow(-1.0, 0.5)</span> is asking for the square root of<span class="code1"> -1</span>, which is a NaN.</p>
<p>You will not need, <em>and should not have</em>, any loops in your code for this assignment. The object is to cleverly use the floating point instructions available in the IA-32 Architecture.  So do not go to the trouble of implementing a mathematical solution like a power series &ndash; that is <em>not</em> what this assignment is asking for. </p>
<p>Start with the provided code  file a02sp.c. Upload your code as <strong>a02sp.c</strong>.</p>
<!-- InstanceEndEditable -->
<p class="header">Compiling Your Code</p>
<p>You are required to use these flags when compiling your code:</p>
<blockquote>
<table width="571" border="0">
  <caption>
    Required gcc Compiler Flags
  </caption>
  <tr>
    <th width="103"><em>flag</em></th>
    <th width="411"><em>effect of specifying flag</em></th>
  </tr>
  <tr>
    <td>-<span class="code">m32</span></td>
    <td>compiles 32-bit code, disallows use of 64-bit integer registers</td>
  </tr>
  <tr>
    <td class="code">-std=gnu99</td>
    <td>allows use of newer features of C</td>
  </tr>
  <tr>
    <td class="code">-Wall</td>
    <td>compiler produces all possible warnings</td>
  </tr>
  <tr>
    <td class="code">-g</td>
    <td>includes information needed by debugger in object code</td>
  </tr>
</table>
</blockquote>
<p>Here is how you would use these flags:</p>
<blockquote>
  <p class="code">gcc -m32 -std=gnu99 -Wall -g yourcode.c -o yourcode</p>
</blockquote>
<p class="header">Grading Your Code</p>
<p>Your code needs to compile without errors or warnings and run correctly. Code that does not compile will receive zero points. Code that crashes will receive zero points.</p>
<p>I use <a href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)" target="_blank">bash</a> scripts to grade your code. Because of this, it is very important that you submit your code <em>with the file name that was requested</em>. If you change the file name, my scripts will crash, your work will not be graded, you will have to resubmit a corrected version of your work, and you will lose points.</p>
<p>My scripts produce a log file containing your code, compiler warnings and errors (if any), your code's output, and some statistics that are useful to me. I then personally go through that log file to produce your grade. In other words, the scripts don't generate your grade, they just make it more convenient for <em>me</em> to generate your grade.</p>
<p class="header">To Submit This Assignment</p>
<p>Submit the requested file to Desire2Learn. &nbsp; Make sure that your code prints your name, assignment description, and number, as requested. </p>
<ul>
  <li>Be  certain to check that you completed the upload successfully. After you click  the Upload File button, you must also click the <strong>SUBMIT ASSIGNMENT </strong>button. This  is very easy to forget. If you do not do this, I will not see your work and you will get a grade of zero for the assignment. I would recommend entering an  email address so you can be notified that the upload was completed  successfully.</li>
  <li>You  may upload as many versions as you wish prior to the due date. I will only see  and grade the final one. You will not be able to upload assignments after due date.</li>
</ul>
<p>Points will be deducted for uploading a file with a name that is not as specified. Every term I get a few students whose approach to following directions is, shall we say, &ldquo;creative.&rdquo; I encourage creativity in general, but there are places where it is <u>not appropriate</u>.</p>
</body>
<!-- InstanceEnd --></html>
